<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>ClusterStoreAndForward (matssocket 0.19.0-2022-11-11 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: io.mats3.matssocket, interface: ClusterStoreAndForward">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">io.mats3.matssocket</a></div>
<h1 title="Interface ClusterStoreAndForward" class="title">Interface ClusterStoreAndForward</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Known Implementing Classes:</dt>
<dd><code><a href="impl/ClusterStoreAndForward_SQL.html" title="class in io.mats3.matssocket.impl">ClusterStoreAndForward_SQL</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">ClusterStoreAndForward</span></div>
<div class="block">MatsSockets forwards requests from WebSocket-connected clients to a Mats Endpoint, and must get the reply back to the
 client. The WebSocket is "static" in that it is a fixed connection to one specific node (as long as the connection is
 up), which means that we need to get the message back to the same node that fired off the request. We could have used
 the same logic as with MatsFuturizer (i.e. the "last jump" uses a node-specific Topic), but that was deemed too
 feeble: We want reliable messaging all the way to the client. We want to be able to handle that the client looses the
 connection (e.g. sitting on a train which drives through a tunnel), and thus will reconnect. He might not come back
 to the same server as last time. We also want to be able to reboot any server (typically deploy of new code) at any
 time, but this obviously kills all WebSockets that are attached to it. To be able to ensure reliable messaging for
 MatsSockets, we need to employ a "store and forward" logic: When the reply comes in, which as with standard Mats
 logic can happen on any node in the cluster of nodes handling this Endpoint Stage, the reply message is temporarily
 stored in some reliable storage. We then look up which node that currently holds the MatsSession, and notify it about
 new messages for that session. This node gets the notice, finds the now local MatsSession, and forwards the message.
 Note that it is possible that the node getting the reply, and the node which holds the WebSocket/MatsSession, is the
 same node, in which case it eventually results in a local forward.
 <p/>
 Each node has his own instance of this class, connected to the same backing datastore.
 <p/>
 It is assumed that the consumption of messages for a session is done single threaded, on one node only. That is, only
 one thread on one node will actually <a href="#getMessagesFromOutbox(java.lang.String,int)"><code>getMessagesFromOutbox(String, int)</code></a> get messages}, and, more
 importantly, <a href="#outboxMessagesComplete(java.lang.String,java.util.Collection)"><code>register them as completed</code></a>. Wrt. multiple nodes,
 this argument still holds, since only one node can hold a MatsSocketSession - the one that has the actual WebSocket
 connection. I believe it is possible to construct a bad async situation here (connect to one node, authenticate, get
 SessionId, immediately disconnect and perform reconnect, and do this until the current <a href="ClusterStoreAndForward.html" title="interface in io.mats3.matssocket"><code>ClusterStoreAndForward</code></a>
 has the wrong idea of which node holds the Session) but this should at most result in the client screwing up for
 himself (not getting messages). A Session is not registered until the client has authenticated, so this will never
 lead to information leakage to other users. Such a situation will also resolve if the client again performs a
 non-malicious reconnect. It is the server that constructs and holds SessionIds: A client cannot itself force the
 server side to create a Session or SessionId - it can only reconnect to an existing SessionId that it was given
 earlier.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Interface</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="ClusterStoreAndForward.CurrentNode.html" class="type-name-link" title="interface in io.mats3.matssocket">ClusterStoreAndForward.CurrentNode</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>static class&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="ClusterStoreAndForward.DataAccessException.html" class="type-name-link" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></div>
<div class="col-last odd-row-color">
<div class="block">If having problems accessing the underlying common data store.</div>
</div>
<div class="col-first even-row-color"><code>static class&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="ClusterStoreAndForward.MessageIdAlreadyExistsException.html" class="type-name-link" title="class in io.mats3.matssocket">ClusterStoreAndForward.MessageIdAlreadyExistsException</a></code></div>
<div class="col-last even-row-color">
<div class="block">Thrown if the operation resulted in a Unique Constraint situation.</div>
</div>
<div class="col-first odd-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="ClusterStoreAndForward.RequestCorrelation.html" class="type-name-link" title="interface in io.mats3.matssocket">ClusterStoreAndForward.RequestCorrelation</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static class&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="ClusterStoreAndForward.SimpleCurrentNode.html" class="type-name-link" title="class in io.mats3.matssocket">ClusterStoreAndForward.SimpleCurrentNode</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>static class&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="ClusterStoreAndForward.SimpleRequestCorrelation.html" class="type-name-link" title="class in io.mats3.matssocket">ClusterStoreAndForward.SimpleRequestCorrelation</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static class&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="ClusterStoreAndForward.SimpleStoredInMessage.html" class="type-name-link" title="class in io.mats3.matssocket">ClusterStoreAndForward.SimpleStoredInMessage</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>static class&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="ClusterStoreAndForward.SimpleStoredOutMessage.html" class="type-name-link" title="class in io.mats3.matssocket">ClusterStoreAndForward.SimpleStoredOutMessage</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="ClusterStoreAndForward.StoredInMessage.html" class="type-name-link" title="interface in io.mats3.matssocket">ClusterStoreAndForward.StoredInMessage</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="ClusterStoreAndForward.StoredOutMessage.html" class="type-name-link" title="interface in io.mats3.matssocket">ClusterStoreAndForward.StoredOutMessage</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static class&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="ClusterStoreAndForward.WrongUserException.html" class="type-name-link" title="class in io.mats3.matssocket">ClusterStoreAndForward.WrongUserException</a></code></div>
<div class="col-last even-row-color">
<div class="block">Thrown from <a href="#registerSessionAtThisNode(java.lang.String,java.lang.String,java.lang.String,java.lang.String,java.lang.String,java.lang.String)"><code>registerSessionAtThisNode(String, String, String, String, String, String)</code></a> if the userId does
 not match the original userId that created this session.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#boot()" class="member-name-link">boot</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Start the <a href="ClusterStoreAndForward.html" title="interface in io.mats3.matssocket"><code>ClusterStoreAndForward</code></a>, perform DB preparations and migrations.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#closeSession(java.lang.String)" class="member-name-link">closeSession</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Invoked when the client explicitly tells us that he closed this session, CLOSE_SESSION.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#deleteMessageIdsFromInbox(java.lang.String,java.util.Collection)" class="member-name-link">deleteMessageIdsFromInbox</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;clientMessageIds)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Deletes the incoming message Ids, as we've established that the client will never try to send this particular
 message again.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#deregisterSessionFromThisNode(java.lang.String,java.lang.String)" class="member-name-link">deregisterSessionFromThisNode</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;connectionId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Deregisters a Session home when a WebSocket is closed.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="ClusterStoreAndForward.RequestCorrelation.html" title="interface in io.mats3.matssocket">ClusterStoreAndForward.RequestCorrelation</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getAndDeleteRequestCorrelation(java.lang.String,java.lang.String)" class="member-name-link">getAndDeleteRequestCorrelation</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;serverMessageId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="ClusterStoreAndForward.CurrentNode.html" title="interface in io.mats3.matssocket">ClusterStoreAndForward.CurrentNode</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getCurrentRegisteredNodeForSession(java.lang.String)" class="member-name-link">getCurrentRegisteredNodeForSession</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="ClusterStoreAndForward.StoredInMessage.html" title="interface in io.mats3.matssocket">ClusterStoreAndForward.StoredInMessage</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getMessageFromInbox(java.lang.String,java.lang.String)" class="member-name-link">getMessageFromInbox</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;clientMessageId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="ClusterStoreAndForward.StoredOutMessage.html" title="interface in io.mats3.matssocket">ClusterStoreAndForward.StoredOutMessage</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getMessagesFromOutbox(java.lang.String,int)" class="member-name-link">getMessagesFromOutbox</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 int&nbsp;maxNumberOfMessages)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Fetch a set of messages, up to 'maxNumberOfMessages' - but do not include messages that have been attempted
 delivered already (marked with <a href="#outboxMessagesAttemptedDelivery(java.lang.String,java.util.Collection)"><code>outboxMessagesAttemptedDelivery(String, Collection)</code></a>).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="MatsSocketServer.MatsSocketSessionDto.html" title="class in io.mats3.matssocket">MatsSocketServer.MatsSocketSessionDto</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getSessions(boolean,java.lang.String,java.lang.String,java.lang.String)" class="member-name-link">getSessions</a><wbr>(boolean&nbsp;onlyActive,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;userId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;appName,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;appVersionAtOrAbove)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Direct implementation of <a href="MatsSocketServer.html#getMatsSocketSessions(boolean,java.lang.String,java.lang.String,java.lang.String)"><code>MatsSocketServer.getMatsSocketSessions(boolean, String, String, String)</code></a> - go
 read there for semantics.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getSessionsCount(boolean,java.lang.String,java.lang.String,java.lang.String)" class="member-name-link">getSessionsCount</a><wbr>(boolean&nbsp;onlyActive,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;userId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;appName,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;appVersionAtOrAbove)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Direct implementation of <a href="MatsSocketServer.html#getMatsSocketSessionsCount(boolean,java.lang.String,java.lang.String,java.lang.String)"><code>MatsSocketServer.getMatsSocketSessionsCount(boolean, String, String, String)</code></a> -
 go read there for semantics.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#isSessionExists(java.lang.String)" class="member-name-link">isSessionExists</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#notifySessionLiveliness(java.util.Collection)" class="member-name-link">notifySessionLiveliness</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;matsSocketSessionIds)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Shall be invoked on some kind of schedule (e.g.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#outboxMessagesAttemptedDelivery(java.lang.String,java.util.Collection)" class="member-name-link">outboxMessagesAttemptedDelivery</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;serverMessageIds)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Marks the specified messages as attempted delivered and notches the <a href="ClusterStoreAndForward.StoredOutMessage.html#getDeliveryCount()"><code>ClusterStoreAndForward.StoredOutMessage.getDeliveryCount()</code></a>
 one up.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#outboxMessagesComplete(java.lang.String,java.util.Collection)" class="member-name-link">outboxMessagesComplete</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;serverMessageIds)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">States that the messages are delivered.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#outboxMessagesDeadLetterQueue(java.lang.String,java.util.Collection)" class="member-name-link">outboxMessagesDeadLetterQueue</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;serverMessageIds)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">States that the messages overran the accepted number of delivery attempts.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#outboxMessagesUnmarkAttemptedDelivery(java.lang.String)" class="member-name-link">outboxMessagesUnmarkAttemptedDelivery</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">When this method is invoked, <a href="#getMessagesFromOutbox(java.lang.String,int)"><code>getMessagesFromOutbox(String, int)</code></a> will again return messages that has
 previously been marked as attempted delivered with <a href="#outboxMessagesAttemptedDelivery(java.lang.String,java.util.Collection)"><code>outboxMessagesAttemptedDelivery(String, Collection)</code></a>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#registerSessionAtThisNode(java.lang.String,java.lang.String,java.lang.String,java.lang.String,java.lang.String,java.lang.String)" class="member-name-link">registerSessionAtThisNode</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;userId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;connectionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;clientLibAndVersions,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;appName,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;appVersion)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Registers a Session home to this node - only one node can ever be home, so any old is deleted.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#scavengeSessionRemnants()" class="member-name-link">scavengeSessionRemnants</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Shall be invoked on some kind of schedule (e.g.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#storeMessageIdInInbox(java.lang.String,java.lang.String)" class="member-name-link">storeMessageIdInInbox</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;clientMessageId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Stores the incoming message Id, to avoid double delivery.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="ClusterStoreAndForward.CurrentNode.html" title="interface in io.mats3.matssocket">ClusterStoreAndForward.CurrentNode</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#storeMessageInOutbox(java.lang.String,java.lang.String,java.lang.String,java.lang.String,io.mats3.matssocket.MatsSocketServer.MessageType,java.lang.Long,java.lang.String,java.lang.String,byte%5B%5D)" class="member-name-link">storeMessageInOutbox</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;serverMessageId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;clientMessageId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;traceId,
 <a href="MatsSocketServer.MessageType.html" title="enum class in io.mats3.matssocket">MatsSocketServer.MessageType</a>&nbsp;type,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;requestTimestamp,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;envelope,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;messageJson,
 byte[]&nbsp;messageBinary)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Stores the message for the Session, returning the nodename for the node holding the session, if any.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#storeRequestCorrelation(java.lang.String,java.lang.String,long,java.lang.String,java.lang.String,byte%5B%5D)" class="member-name-link">storeRequestCorrelation</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;serverMessageId,
 long&nbsp;requestTimestamp,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;replyTerminatorId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;correlationString,
 byte[]&nbsp;correlationBinary)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#timeoutSessions(long)" class="member-name-link">timeoutSessions</a><wbr>(long&nbsp;notLiveSinceTimestamp)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Shall be invoked on some kind of schedule (e.g.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#updateMessageInInbox(java.lang.String,java.lang.String,java.lang.String,byte%5B%5D)" class="member-name-link">updateMessageInInbox</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;clientMessageId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;messageJson,
 byte[]&nbsp;messageBinary)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Stores the resulting message (envelope and binary), so that if the incoming messages comes again (based on
 <a href="#storeMessageIdInInbox(java.lang.String,java.lang.String)"><code>storeMessageIdInInbox(String, String)</code></a> throwing <a href="ClusterStoreAndForward.MessageIdAlreadyExistsException.html" title="class in io.mats3.matssocket"><code>ClusterStoreAndForward.MessageIdAlreadyExistsException</code></a>), the result from
 the previous processing can be returned right away.</div>
</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="boot()">
<h3>boot</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">boot</span>()</div>
<div class="block">Start the <a href="ClusterStoreAndForward.html" title="interface in io.mats3.matssocket"><code>ClusterStoreAndForward</code></a>, perform DB preparations and migrations.</div>
</section>
</li>
<li>
<section class="detail" id="registerSessionAtThisNode(java.lang.String,java.lang.String,java.lang.String,java.lang.String,java.lang.String,java.lang.String)">
<h3>registerSessionAtThisNode</h3>
<div class="member-signature"><span class="return-type">long</span>&nbsp;<span class="element-name">registerSessionAtThisNode</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;userId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;connectionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;clientLibAndVersions,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;appName,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;appVersion)</span>
                        throws <span class="exceptions"><a href="ClusterStoreAndForward.WrongUserException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.WrongUserException</a>,
<a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Registers a Session home to this node - only one node can ever be home, so any old is deleted. When
 "re-registering" a session, it is asserted that the provided 'userId' is the same UserId as originally registered
 - a <a href="ClusterStoreAndForward.WrongUserException.html" title="class in io.mats3.matssocket"><code>ClusterStoreAndForward.WrongUserException</code></a> is thrown if this does not match.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the SessionId for this connection.</dd>
<dd><code>userId</code> - the UserId, as provided by <a href="AuthenticationPlugin.html" title="interface in io.mats3.matssocket"><code>AuthenticationPlugin</code></a>, that own this MatsSocketSessionId</dd>
<dd><code>connectionId</code> - an id that is unique for this specific WebSocket Session (i.e. TCP Connection), so that if it closes,
            a new registration will not be deregistered by the old MatsSocketSession realizing that it is closed
            and then invoking <a href="#deregisterSessionFromThisNode(java.lang.String,java.lang.String)"><code>deregisterSessionFromThisNode(String, String)</code></a></dd>
<dd><code>clientLibAndVersions</code> - the Client Library and Versions + runtime information for the Client.</dd>
<dd><code>appName</code> - the AppName of the accessing Client app</dd>
<dd><code>appVersion</code> - the AppVersion of the accessing Client app</dd>
<dt>Returns:</dt>
<dd>the created timestamp - which is either "now" if this is the first register, or if it a "reconnect", when
         this MatsSocketSession was initially created</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.WrongUserException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.WrongUserException</a></code> - if the userId provided does not match the original userId that created the session.</dd>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code> - if problems with underlying data store.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getCurrentRegisteredNodeForSession(java.lang.String)">
<h3>getCurrentRegisteredNodeForSession</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="ClusterStoreAndForward.CurrentNode.html" title="interface in io.mats3.matssocket">ClusterStoreAndForward.CurrentNode</a>&gt;</span>&nbsp;<span class="element-name">getCurrentRegisteredNodeForSession</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId)</span>
                                                                         throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the MatsSocketSessionId for which to find current session home.</dd>
<dt>Returns:</dt>
<dd>the current node holding MatsSocket Session, or empty if none.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isSessionExists(java.lang.String)">
<h3>isSessionExists</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="element-name">isSessionExists</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId)</span>
                 throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the MatsSocketSessionId for which to check whether there is a session</dd>
<dt>Returns:</dt>
<dd>whether a CSAF Session exists - NOTE: Not whether it is currently registered!</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getSessions(boolean,java.lang.String,java.lang.String,java.lang.String)">
<h3>getSessions</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="MatsSocketServer.MatsSocketSessionDto.html" title="class in io.mats3.matssocket">MatsSocketServer.MatsSocketSessionDto</a>&gt;</span>&nbsp;<span class="element-name">getSessions</span><wbr><span class="parameters">(boolean&nbsp;onlyActive,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;userId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;appName,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;appVersionAtOrAbove)</span>
                                                 throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Direct implementation of <a href="MatsSocketServer.html#getMatsSocketSessions(boolean,java.lang.String,java.lang.String,java.lang.String)"><code>MatsSocketServer.getMatsSocketSessions(boolean, String, String, String)</code></a> - go
 read there for semantics.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the list of all MatsSocketSessions currently registered with this MatsSocketServer instance matching the
         constraints if set - as read from the <a href="ClusterStoreAndForward.html" title="interface in io.mats3.matssocket"><code>data store</code></a>.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getSessionsCount(boolean,java.lang.String,java.lang.String,java.lang.String)">
<h3>getSessionsCount</h3>
<div class="member-signature"><span class="return-type">int</span>&nbsp;<span class="element-name">getSessionsCount</span><wbr><span class="parameters">(boolean&nbsp;onlyActive,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;userId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;appName,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;appVersionAtOrAbove)</span>
              throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Direct implementation of <a href="MatsSocketServer.html#getMatsSocketSessionsCount(boolean,java.lang.String,java.lang.String,java.lang.String)"><code>MatsSocketServer.getMatsSocketSessionsCount(boolean, String, String, String)</code></a> -
 go read there for semantics.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the count of all MatsSocketSessions currently registered with this MatsSocketServer instance matching the
         constraints if set - as read from the <a href="ClusterStoreAndForward.html" title="interface in io.mats3.matssocket"><code>data store</code></a>.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="deregisterSessionFromThisNode(java.lang.String,java.lang.String)">
<h3>deregisterSessionFromThisNode</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">deregisterSessionFromThisNode</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;connectionId)</span>
                            throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Deregisters a Session home when a WebSocket is closed. This node's nodename and this WebSocket Session's
 ConnectionId is taken into account, so that if it has changed async, it will not deregister a new session home
 (which can potentially be on the same node the 'connectionId' parameter).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the MatsSocketSessionId for which to deregister the specific WebSocket Session's ConnectionId.</dd>
<dd><code>connectionId</code> - an id that is unique for this specific WebSocket Session (i.e. TCP Connection), so that if it closes,
            a new registration will not be deregistered by the old MatsSocketSession realizing that it is closed
            and then invoking <a href="#deregisterSessionFromThisNode(java.lang.String,java.lang.String)"><code>deregisterSessionFromThisNode(String, String)</code></a></dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="closeSession(java.lang.String)">
<h3>closeSession</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">closeSession</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId)</span>
           throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Invoked when the client explicitly tells us that he closed this session, CLOSE_SESSION. This deletes the session
 instance, and any messages in queue for it. No new incoming REPLYs, SENDs or RECEIVEs for this SessionId will be
 sent anywhere. (Notice that the implementation might still store any new outboxed messages, not checking that the
 session actually exists. But this SessionId will never be reused (exception without extreme "luck"), and the
 implementation will periodically purge such non-session-attached outbox messages).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the MatsSocketSessionId that should be closed.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="notifySessionLiveliness(java.util.Collection)">
<h3>notifySessionLiveliness</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">notifySessionLiveliness</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;matsSocketSessionIds)</span>
                      throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Shall be invoked on some kind of schedule (e.g. every 1 minute) by every node to inform
 <a href="ClusterStoreAndForward.html" title="interface in io.mats3.matssocket"><code>ClusterStoreAndForward</code></a> about which Sessions are currently live on that node. Sessions that aren't live,
 will be scavenged after some time by invocation of <a href="#timeoutSessions(long)"><code>timeoutSessions(long)</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionIds</code> - which sessions are currently live on the invoking node.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="timeoutSessions(long)">
<h3>timeoutSessions</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</span>&nbsp;<span class="element-name">timeoutSessions</span><wbr><span class="parameters">(long&nbsp;notLiveSinceTimestamp)</span>
                            throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Shall be invoked on some kind of schedule (e.g. every 10 minutes <i>on average</i>). Times out any session which
 have not been <a href="#notifySessionLiveliness(java.util.Collection)"><code>notified about liveliness</code></a> since the supplied timestamp
 (millis from epoch).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>notLiveSinceTimestamp</code> - decides which sessions are too old: Sessions which have not been
            <a href="#notifySessionLiveliness(java.util.Collection)"><code>notified about liveliness</code></a> since this timestamp will be
            deleted.</dd>
<dt>Returns:</dt>
<dd>which sessions was timed out.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="scavengeSessionRemnants()">
<h3>scavengeSessionRemnants</h3>
<div class="member-signature"><span class="return-type">int</span>&nbsp;<span class="element-name">scavengeSessionRemnants</span>()
                     throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Shall be invoked on some kind of schedule (e.g. every hour <i>on average</i>). Scavenges all inboxes, outboxes
 and "request boxes" for any lingering data for closed and timed out sessions.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>how many items was scavenged, for logging. May return constant zero if not readily available.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="storeMessageIdInInbox(java.lang.String,java.lang.String)">
<h3>storeMessageIdInInbox</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">storeMessageIdInInbox</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;clientMessageId)</span>
                    throws <span class="exceptions"><a href="ClusterStoreAndForward.MessageIdAlreadyExistsException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.MessageIdAlreadyExistsException</a>,
<a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Stores the incoming message Id, to avoid double delivery. If the Client MessageId (cmid) already exists, a
 <a href="ClusterStoreAndForward.MessageIdAlreadyExistsException.html" title="class in io.mats3.matssocket"><code>ClusterStoreAndForward.MessageIdAlreadyExistsException</code></a> will be raised - this implies that a double delivery has occurred.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the MatsSocketSessionId for which to store the incoming message id.</dd>
<dd><code>clientMessageId</code> - the client's message Id for the incoming message.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.MessageIdAlreadyExistsException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.MessageIdAlreadyExistsException</a></code> - if the Client MessageId (cmid) already existed for this SessionId.</dd>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="updateMessageInInbox(java.lang.String,java.lang.String,java.lang.String,byte[])">
<h3>updateMessageInInbox</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">updateMessageInInbox</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;clientMessageId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;messageJson,
 byte[]&nbsp;messageBinary)</span>
                   throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Stores the resulting message (envelope and binary), so that if the incoming messages comes again (based on
 <a href="#storeMessageIdInInbox(java.lang.String,java.lang.String)"><code>storeMessageIdInInbox(String, String)</code></a> throwing <a href="ClusterStoreAndForward.MessageIdAlreadyExistsException.html" title="class in io.mats3.matssocket"><code>ClusterStoreAndForward.MessageIdAlreadyExistsException</code></a>), the result from
 the previous processing can be returned right away.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getMessageFromInbox(java.lang.String,java.lang.String)">
<h3>getMessageFromInbox</h3>
<div class="member-signature"><span class="return-type"><a href="ClusterStoreAndForward.StoredInMessage.html" title="interface in io.mats3.matssocket">ClusterStoreAndForward.StoredInMessage</a></span>&nbsp;<span class="element-name">getMessageFromInbox</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;clientMessageId)</span>
                                                    throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="deleteMessageIdsFromInbox(java.lang.String,java.util.Collection)">
<h3>deleteMessageIdsFromInbox</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">deleteMessageIdsFromInbox</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;clientMessageIds)</span>
                        throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Deletes the incoming message Ids, as we've established that the client will never try to send this particular
 message again.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the MatsSocketSessionId for which to delete the incoming message id.</dd>
<dd><code>clientMessageIds</code> - the client's message Ids for the incoming messages to delete.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="storeMessageInOutbox(java.lang.String,java.lang.String,java.lang.String,java.lang.String,io.mats3.matssocket.MatsSocketServer.MessageType,java.lang.Long,java.lang.String,java.lang.String,byte[])">
<h3>storeMessageInOutbox</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="ClusterStoreAndForward.CurrentNode.html" title="interface in io.mats3.matssocket">ClusterStoreAndForward.CurrentNode</a>&gt;</span>&nbsp;<span class="element-name">storeMessageInOutbox</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;serverMessageId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;clientMessageId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;traceId,
 <a href="MatsSocketServer.MessageType.html" title="enum class in io.mats3.matssocket">MatsSocketServer.MessageType</a>&nbsp;type,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;requestTimestamp,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;envelope,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;messageJson,
 byte[]&nbsp;messageBinary)</span>
                                                           throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a>,
<a href="ClusterStoreAndForward.MessageIdAlreadyExistsException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.MessageIdAlreadyExistsException</a></span></div>
<div class="block">Stores the message for the Session, returning the nodename for the node holding the session, if any. If the
 session is closed/timed out, the message won't be stored (i.e. dumped on the floor) and the return value is
 empty. The Server MessageId (smid) is set by the caller - and since this might have a collision, the method
 throws <a href="ClusterStoreAndForward.MessageIdAlreadyExistsException.html" title="class in io.mats3.matssocket"><code>ClusterStoreAndForward.MessageIdAlreadyExistsException</code></a> if unique constraint fails. In this case, a new Server MessageId
 should be picked and try again.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the matsSocketSessionId that the message is meant for.</dd>
<dd><code>serverMessageId</code> - unique id for outbox'ed message within the MatsSocketSessionId. Must be long enough that it is
            <b><i>extremely</i></b> unlikely that is collides with another message within the same
            MatsSocketSessionId - but do remember that there will at any one time be pretty few messages in the
            outbox for a given MatsSocketSession.</dd>
<dd><code>clientMessageId</code> - <b>For Client Replies to requests from Server-to-Client</b>, this is the Client's Message Id, which we
            need to send back with the Reply so that the Client can correlate the Request. (Nullable, since not
            all messages are replies).</dd>
<dd><code>traceId</code> - the server-side traceId for this message.</dd>
<dd><code>type</code> - the type of the outgoing message (RESOLVE, REJECT or PUB).</dd>
<dd><code>requestTimestamp</code> - <b>For Client Replies to requests from Server-to-Client</b>, this is the timestamp we received the
            Request.</dd>
<dd><code>envelope</code> - the JSON-serialized MatsSocket Envelope <b>without the 'msg' field set</b>.</dd>
<dd><code>messageJson</code> - the JSON-serialized message - the piece that sits in the 'msg' field of the Envelope. (Nullable)</dd>
<dd><code>messageBinary</code> - the binary part of an outgoing message. (Nullable)</dd>
<dt>Returns:</dt>
<dd>the current node holding MatsSocket Session, or empty if none.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.MessageIdAlreadyExistsException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.MessageIdAlreadyExistsException</a></code> - if the Server MessageId (smid) already existed for this SessionId.</dd>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getMessagesFromOutbox(java.lang.String,int)">
<h3>getMessagesFromOutbox</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="ClusterStoreAndForward.StoredOutMessage.html" title="interface in io.mats3.matssocket">ClusterStoreAndForward.StoredOutMessage</a>&gt;</span>&nbsp;<span class="element-name">getMessagesFromOutbox</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 int&nbsp;maxNumberOfMessages)</span>
                                                             throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Fetch a set of messages, up to 'maxNumberOfMessages' - but do not include messages that have been attempted
 delivered already (marked with <a href="#outboxMessagesAttemptedDelivery(java.lang.String,java.util.Collection)"><code>outboxMessagesAttemptedDelivery(String, Collection)</code></a>). If
 <a href="#outboxMessagesUnmarkAttemptedDelivery(java.lang.String)"><code>outboxMessagesUnmarkAttemptedDelivery(String)</code></a> is invoked, that mark will be unset.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the matsSocketSessionId that the message is meant for.</dd>
<dd><code>maxNumberOfMessages</code> - the maximum number of messages to fetch.</dd>
<dt>Returns:</dt>
<dd>a list of json encoded messages destined for the WebSocket.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="outboxMessagesAttemptedDelivery(java.lang.String,java.util.Collection)">
<h3>outboxMessagesAttemptedDelivery</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">outboxMessagesAttemptedDelivery</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;serverMessageIds)</span>
                              throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">Marks the specified messages as attempted delivered and notches the <a href="ClusterStoreAndForward.StoredOutMessage.html#getDeliveryCount()"><code>ClusterStoreAndForward.StoredOutMessage.getDeliveryCount()</code></a>
 one up. If <a href="#outboxMessagesUnmarkAttemptedDelivery(java.lang.String)"><code>outboxMessagesUnmarkAttemptedDelivery(String)</code></a> is invoked (typically on reconnect), the mark
 will be unset, but the delivery count will stay in place - this is to be able to abort delivery attempts if there
 is something wrong with the message.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the matsSocketSessionId that the serverMessageIds refers to.</dd>
<dd><code>serverMessageIds</code> - which messages failed delivery.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="outboxMessagesUnmarkAttemptedDelivery(java.lang.String)">
<h3>outboxMessagesUnmarkAttemptedDelivery</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">outboxMessagesUnmarkAttemptedDelivery</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId)</span>
                                    throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">When this method is invoked, <a href="#getMessagesFromOutbox(java.lang.String,int)"><code>getMessagesFromOutbox(String, int)</code></a> will again return messages that has
 previously been marked as attempted delivered with <a href="#outboxMessagesAttemptedDelivery(java.lang.String,java.util.Collection)"><code>outboxMessagesAttemptedDelivery(String, Collection)</code></a>.
 Notice that the <a href="ClusterStoreAndForward.StoredOutMessage.html#getDeliveryCount()"><code>ClusterStoreAndForward.StoredOutMessage.getDeliveryCount()</code></a> will not be reset, but the
 <a href="ClusterStoreAndForward.StoredOutMessage.html#getAttemptTimestamp()"><code>ClusterStoreAndForward.StoredOutMessage.getAttemptTimestamp()</code></a> will now again return null.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the matsSocketSessionId whose messages now shall be attempted.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="outboxMessagesComplete(java.lang.String,java.util.Collection)">
<h3>outboxMessagesComplete</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">outboxMessagesComplete</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;serverMessageIds)</span>
                     throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">States that the messages are delivered. Will typically delete the message.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the matsSocketSessionId that the serverMessageIds refers to.</dd>
<dd><code>serverMessageIds</code> - which messages are complete.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="outboxMessagesDeadLetterQueue(java.lang.String,java.util.Collection)">
<h3>outboxMessagesDeadLetterQueue</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">outboxMessagesDeadLetterQueue</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;serverMessageIds)</span>
                            throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<div class="block">States that the messages overran the accepted number of delivery attempts.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>matsSocketSessionId</code> - the matsSocketSessionId that the serverMessageIds refers to.</dd>
<dd><code>serverMessageIds</code> - which messages should be DLQed.</dd>
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="storeRequestCorrelation(java.lang.String,java.lang.String,long,java.lang.String,java.lang.String,byte[])">
<h3>storeRequestCorrelation</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">storeRequestCorrelation</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;serverMessageId,
 long&nbsp;requestTimestamp,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;replyTerminatorId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;correlationString,
 byte[]&nbsp;correlationBinary)</span>
                      throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getAndDeleteRequestCorrelation(java.lang.String,java.lang.String)">
<h3>getAndDeleteRequestCorrelation</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="ClusterStoreAndForward.RequestCorrelation.html" title="interface in io.mats3.matssocket">ClusterStoreAndForward.RequestCorrelation</a>&gt;</span>&nbsp;<span class="element-name">getAndDeleteRequestCorrelation</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;matsSocketSessionId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;serverMessageId)</span>
                                                                            throws <span class="exceptions"><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></span></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="ClusterStoreAndForward.DataAccessException.html" title="class in io.mats3.matssocket">ClusterStoreAndForward.DataAccessException</a></code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
